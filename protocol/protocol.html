<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Protocol – Countdown</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{--blue:#1e90ff;--red:#e74c3c;--bg:#f4f4f4}
    body{font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);margin:0;padding:1rem}
    .container{max-width:900px;margin:2rem auto;background:#fff;border-radius:10px;padding:1rem;box-shadow:0 10px 25px rgba(0,0,0,0.08)}
    .layout{display:grid;grid-template-columns:1fr 320px;gap:1rem;align-items:start}
    /* Board and timeline area */
    .board-area{display:flex;flex-direction:column;gap:0.75rem}
    .boards{display:flex;gap:0.5rem}
    .board{flex:1;background:#fafafa;border-radius:8px;padding:0.6rem;display:flex;align-items:center;justify-content:space-between;gap:0.5rem}
    .board.blue{border:2px solid var(--blue)}
    .board.red{border:2px solid var(--red)}
    .board .info{background:transparent;border:none;padding:0.4rem 0.6rem;border-radius:6px;cursor:pointer}
    .board .name{font-weight:600}
    /* Mirror red side: info on left, name right-aligned */
    .board.red{direction:ltr}
    .board.red .left{order:0}
    .board.red .right{order:1;margin-left:auto;text-align:right}

    /* Timer and controls */
    .controls{display:flex;flex-direction:column;gap:0.75rem;align-items:stretch}
    .timer{background:#fff;padding:1rem;border-radius:8px;text-align:center;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
    .time{font-size:3rem;font-variant-numeric:tabular-nums;margin-bottom:0.5rem}
    .btn-row{display:flex;gap:0.5rem;justify-content:center}
    button{font-size:1rem;padding:0.5rem 1rem;border-radius:6px;border:1px solid #ddd;background:#fff;cursor:pointer}
    button.primary{background:var(--blue);color:#fff;border-color:transparent}

    /* Bout-time button: label inside, hint included */
    .bout-button{display:block;width:100%;padding:0.8rem 1rem;border-radius:8px;border:2px solid #ccc;background:#fff;font-size:1rem;text-align:center;cursor:pointer}
    .bout-button .label{display:block;font-weight:700}
    .bout-button .hint{display:block;font-size:0.85rem;color:#666;margin-top:0.15rem}

    /* Complete button between board and timeline, full width */
    .complete-wrapper{display:flex;justify-content:center}
    .complete-button{width:100%;max-width:420px;padding:0.7rem;border-radius:8px;background:#2ecc71;color:#fff;border:none;cursor:pointer}

    /* Timeline placeholder */
    .timeline{background:#fafafa;border-radius:8px;padding:0.6rem;height:220px}

    @media (max-width:900px){.layout{grid-template-columns:1fr;}.complete-button{max-width:100%}}
  </style>
</head>
<body>
  <div class="container">
    <div class="layout">
      <div class="board-area">
        <div class="boards">
          <div class="board blue" aria-label="Blue board">
            <div class="left">
              <button class="info" aria-label="Blue info">Info</button>
            </div>
            <div class="right">
              <div class="name">Blau</div>
            </div>
          </div>
          <div class="board red" aria-label="Red board">
            <div class="left">
              <!-- For red side we intentionally put Info on the left (mirrored) -->
              <button class="info" aria-label="Red info">Info</button>
            </div>
            <div class="right">
              <div class="name">Rot</div>
            </div>
          </div>
        </div>

        <!-- Complete button should appear between board area and timeline and expand to full width -->
        <div class="complete-wrapper" style="margin-top:0.5rem">
          <button class="complete-button" id="complete">Complete</button>
        </div>

        <div class="timeline" aria-hidden="true">
          <!-- Placeholder for timeline / events -->
        </div>
      </div>

      <div class="controls">
        <div class="timer" role="region" aria-label="Countdown timer">
          <div class="time" id="display">3:00</div>
          <div class="btn-row">
            <!-- Bout Time button with label inside and hint; this replaces separate label and shows keyboard hint (Space) -->
            <button class="bout-button" id="boutTime" aria-pressed="false">
              <span class="label">Bout Time</span>
              <span class="hint">Tap to Start / Stop — press Space</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Timer logic preserved from original file. Bout-time button toggles start/stop.
    const START_TIME_SECONDS = 3 * 60;
    let remainingSeconds = START_TIME_SECONDS;
    let intervalId = null;
    const display = document.getElementById("display");
    const boutButton = document.getElementById("boutTime");
    const completeButton = document.getElementById("complete");

    function updateDisplay() {
      const minutes = Math.floor(remainingSeconds / 60);
      const seconds = remainingSeconds % 60;
      display.textContent = minutes + ":" + seconds.toString().padStart(2, "0");
    }

    function tick() {
      if (remainingSeconds > 0) {
        remainingSeconds--;
        updateDisplay();
      } else {
        stopTimer();
      }
    }

    function startTimer() {
      if (intervalId !== null) return;
      intervalId = setInterval(tick, 1000);
      boutButton.setAttribute('aria-pressed','true');
    }

    function stopTimer() {
      clearInterval(intervalId);
      intervalId = null;
      boutButton.setAttribute('aria-pressed','false');
    }

    function toggleTimer() {
      if (intervalId === null) startTimer(); else stopTimer();
    }

    // Click on bout button toggles timer
    boutButton.addEventListener('click', toggleTimer);

    // Keyboard: Space key toggles timer when focused on body (makes test automation via Playwright easier)
    window.addEventListener('keydown', function(e){
      // If user focuses on an input or textarea, ignore to avoid interfering with typing
      const tag = (document.activeElement && document.activeElement.tagName) || '';
      if (tag === 'INPUT' || tag === 'TEXTAREA') return;
      if (e.code === 'Space' || e.key === ' ') {
        e.preventDefault();
        toggleTimer();
      }
    })

    // Complete button: emit a simple event (placeholder for app logic)
    completeButton.addEventListener('click', function(){
      // This is a UI-only prototype change. In the full app this would finalize the bout.
      completeButton.disabled = true;
      completeButton.textContent = 'Completed';
    });

    updateDisplay();
  </script>
</body>
</html>
